$(document).ready(function(event){
	$(document).on("click", ".add-event", function(event) {	      
                var url = $(this).find("a").attr("href");
                event.preventDefault();
                $.get(url, function(data){

			$.modal({
				content : data,
				title : 'Add Event',
				width : 700,
				buttons : {
					'Close' : function(win) {
						win.closeModal();
					},
					'Create Event' : function(win) {
						
						var title = $('#events_title').val();
						var description = $('#events_description').val();					
						var start_date = $('#events_start_date').val();
						var end_date = $('#events_end_date').val();
						var is_holiday = $('#events_is_holiday').val();
						var is_common = $('#events_is_common').val();

							var taget = url;
							var data1 = {
								'event[title]' : title,
								'event[description]' : description,
								'event[start_date]' : start_date,
								'event[end_date]' : end_date,
								'event[is_holiday]' : is_holiday,
								'event[is_common]' : is_common
							}

							ajaxCreateEvent(taget, data1, win);
				// }
						// //var element = $(context, '#course_course_name');
// 								
						// //win.closeModal();
					}
				}
			});
                });
	});
	
});
function ajaxCreateEvent(target, data, win) {
	$.ajax({
		url : target,
		dataType : 'json',
		data : data,
		success : function(data, textStatus, jqXHR) {
			if(data.valid) {
				alert("Done");
				
			} else {
				alert("not Done");
				var errorText = getErrorText(data.errors);
				$('#modal #outer_block').removeBlockMessages().blockMessage(errorText || 'An unexpected error occured, please try again', {
					type : 'error'
				});
				
			}
		},
		error : function(jqXHR, textStatus, errorThrown) {
			// Message
			$('#modal #outer_block').removeBlockMessages().blockMessage('Error while contacting server, please try again', {
				type : 'error'
			});
			
		}
	});

	// Message
	$('#modal #outer_block').removeBlockMessages().blockMessage('Please wait, connecting to backend...', {
		type : 'loading'
	});
	
}